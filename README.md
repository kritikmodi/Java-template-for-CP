 I've optimized this template and the contained functions to give minimal TLEs during contests. But still, convert to CPP if recursion is deeper than 1e5 or number of operations are more than 1e7. 
